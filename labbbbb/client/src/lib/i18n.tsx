import React, { createContext, useContext, useState, useEffect } from "react";

export type Language = "en" | "hi" | "mr" | "gu";

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const translations: Record<Language, Record<string, string>> = {
  en: {
    "login.title": "Login",
    "login.subtitle": "Welcome back, Quality Analyst",
    "login.helper_text": "Enter your mobile number or email to continue",
    "login.mobile": "Mobile",
    "login.email": "Email",
    "login.phone": "Phone Number",
    "login.email_address": "Email Address",
    "login.send_otp": "Send OTP",
    "login.otp": "Enter OTP",
    "login.otp_placeholder": "000000",
    "login.verify": "Verify",
    "login.resend": "Resend OTP",
    "login.resend_in": "Resend in {seconds}s",
    "login.otp_sent": "OTP sent successfully",
    "login.invalid_otp": "Invalid OTP. Please try again.",
    "dashboard.title": "Dashboard",
    "dashboard.assigned": "Samples Assigned",
    "dashboard.attention": "Require Attention",
    "dashboard.accuracy": "Testing Accuracy",
    "dashboard.activity": "Recent Activity",
    "samples.title": "Samples",
    "samples.status": "Status",
    "samples.temperature": "Temperature",
    "samples.humidity": "Humidity",
    "samples.test_result": "Test Result",
    "samples.upload_report": "Upload Lab Test Report",
    "samples.upload_format": "PDF, JPG, PNG supported",
    "samples.upload_hint": "Click to select",
    "samples.upload_change": "Click to change",
    "samples.remarks": "Remarks / Observations",
    "samples.no_recalls": "No active recalls",
    "samples.submit": "Submit Result",
    "samples.test_result_pass": "Pass",
    "samples.test_result_fail": "Fail",
    "samples.test_result_retest": "Requires Retest",
    "recalls.title": "Recalls",
    "notifications.title": "Notifications",
    "profile.title": "Profile",
    "status.pending": "Pending",
    "status.in_testing": "Testing",
    "status.completed": "Completed",
    "status.rejected": "Rejected",
    "status.recalled": "Recalled",
    "status.high": "High",
    "status.warning": "Warning",
    "status.info": "Info",
    "nav.dashboard": "Home",
    "nav.samples": "Samples",
    "nav.herbs": "Herbs",
    "nav.recalls": "Recalls",
    "nav.profile": "Profile",
    "common.batch": "Batch ID",
    "common.logout": "Logout",
    "common.close": "Close",
    "common.offline": "You are currently offline. Showing saved data.",
    "common.offline_mode": "Offline mode – data will sync automatically",
    "samples.download_report": "Download Lab Report (PDF)",
    "samples.timeline": "Timeline",
    "samples.notify_farmer": "Notify Farmer",
    "samples.recall_action": "Recall Needs Action",
    "profile.mobile_number": "Mobile Number",
    "profile.area_location": "Area / Village, State",
    "profile.language": "Language",
    "profile.not_provided": "Not provided",
    "profile.edit_profile": "Edit Profile",
    "profile.settings": "Settings",
    "profile.lang_en": "English",
    "profile.lang_hi": "हिंदी",
    "profile.lang_mr": "मराठी",
    "profile.lang_gu": "ગુજરાતી",
    "settings.title": "Settings",
    "settings.dark_mode": "Dark Mode",
    "settings.dark_mode_enabled": "Currently enabled",
    "settings.dark_mode_disabled": "Currently disabled",
    "settings.notifications": "Notifications",
    "settings.notifications_subtitle": "Receive alert notifications",
    "settings.language": "Language",
    "settings.help_support": "Help & Support",
    "settings.help_support_subtitle": "Get assistance",
    "settings.privacy_policy": "Privacy Policy",
    "settings.privacy_policy_subtitle": "Read our policies",
    "settings.version": "Version 1.0.0",
    "herbs.title": "Manage Herbs",
    "herbs.add_new": "Add New Herb",
    "herbs.add_new_herb": "Add New Herb",
    "herbs.add_herb_description": "Add a new herb to your laboratory's herb database",
    "herbs.category": "Category",
    "herbs.added_by": "Added By",
    "herbs.lab_id": "Lab ID",
    "herbs.notes": "Notes",
    "herbs.no_herbs": "No herbs added yet. Click 'Add New Herb' to get started.",
    "herbs.herb_name": "Herb Name",
    "herbs.herb_name_placeholder": "e.g., Tulsi, Ashwagandha",
    "herbs.lab_name": "Lab Name",
    "herbs.select_category": "Select a category",
    "herbs.notes_placeholder": "Optional notes about this herb",
    "herbs.save_herb": "Save Herb",
    "common.cancel": "Cancel",
    "samples.source_box": "Source Box",
    "samples.hub_id": "Hub ID",
    "samples.qr_scan": "Scan QR to verify source",
    "samples.auto_creation_info": "Samples are automatically created when farmers add storage boxes.",
  },
  hi: {
    "login.title": "लॉगिन",
    "login.subtitle": "वापस स्वागत है, गुणवत्ता विश्लेषक",
    "login.helper_text": "जारी रखने के लिए अपना मोबाइल नंबर या ईमेल दर्ज करें",
    "login.mobile": "मोबाइल",
    "login.email": "ईमेल",
    "login.phone": "फोन नंबर",
    "login.email_address": "ईमेल पता",
    "login.send_otp": "OTP भेजें",
    "login.otp": "OTP दर्ज करें",
    "login.otp_placeholder": "000000",
    "login.verify": "सत्यापित करें",
    "login.resend": "OTP फिर से भेजें",
    "login.resend_in": "{seconds}s में फिर से भेजें",
    "login.otp_sent": "OTP सफलतापूर्वक भेजा गया",
    "login.invalid_otp": "अमान्य OTP। कृपया पुनः प्रयास करें।",
    "dashboard.title": "डैशबोर्ड",
    "dashboard.assigned": "आवंटित नमूने",
    "dashboard.attention": "ध्यान दें",
    "dashboard.accuracy": "परीक्षण सटीकता",
    "dashboard.activity": "हाल की गतिविधि",
    "samples.title": "नमूने",
    "samples.status": "स्थिति",
    "samples.temperature": "तापमान",
    "samples.humidity": "आर्द्रता",
    "samples.test_result": "परीक्षण परिणाम",
    "samples.upload_report": "प्रयोगशाला परीक्षण रिपोर्ट अपलोड करें",
    "samples.upload_format": "PDF, JPG, PNG समर्थित",
    "samples.upload_hint": "चुनने के लिए क्लिक करें",
    "samples.upload_change": "बदलने के लिए क्लिक करें",
    "samples.remarks": "टिप्पणियाँ / अवलोकन",
    "samples.no_recalls": "कोई सक्रिय रिकॉल नहीं",
    "samples.submit": "परिणाम जमा करें",
    "samples.test_result_pass": "पास",
    "samples.test_result_fail": "विफल",
    "samples.test_result_retest": "पुनः परीक्षण आवश्यक",
    "recalls.title": "वापसी",
    "notifications.title": "सूचनाएं",
    "profile.title": "प्रोफ़ाइल",
    "status.pending": "लंबित",
    "status.in_testing": "परीक्षण",
    "status.completed": "पूर्ण",
    "status.rejected": "अस्वीकृत",
    "status.recalled": "वापस बुलाया गया",
    "status.high": "उच्च",
    "status.warning": "चेतावनी",
    "status.info": "जानकारी",
    "nav.dashboard": "होम",
    "nav.samples": "नमूने",
    "nav.herbs": "जड़ी बूटियां",
    "nav.recalls": "वापसी",
    "nav.profile": "प्रोफ़ाइल",
    "common.batch": "बैच आईडी",
    "common.logout": "लॉग आउट",
    "common.close": "बंद करें",
    "common.offline": "आप ऑफ़लाइन हैं। सहेजा गया डेटा दिखा रहा है।",
    "common.offline_mode": "ऑफलाइन मोड – डेटा स्वचालित रूप से सिंक होगा",
    "samples.download_report": "प्रयोगशाला रिपोर्ट डाउनलोड करें (PDF)",
    "samples.timeline": "समयरेखा",
    "samples.notify_farmer": "किसान को सूचित करें",
    "samples.recall_action": "रिकॉल को कार्रवाई की आवश्यकता है",
    "profile.mobile_number": "मोबाइल नंबर",
    "profile.area_location": "क्षेत्र / गांव, राज्य",
    "profile.language": "भाषा",
    "profile.not_provided": "प्रदान नहीं किया गया",
    "profile.edit_profile": "प्रोफ़ाइल संपादित करें",
    "profile.settings": "सेटिंग्स",
    "profile.lang_en": "English",
    "profile.lang_hi": "हिंदी",
    "profile.lang_mr": "मराठी",
    "profile.lang_gu": "ગુજરાતી",
    "settings.title": "सेटिंग्स",
    "settings.dark_mode": "डार्क मोड",
    "settings.dark_mode_enabled": "वर्तमान में सक्षम",
    "settings.dark_mode_disabled": "वर्तमान में अक्षम",
    "settings.notifications": "सूचनाएं",
    "settings.notifications_subtitle": "सतर्क सूचनाएं प्राप्त करें",
    "settings.language": "भाषा",
    "settings.help_support": "मदद और समर्थन",
    "settings.help_support_subtitle": "सहायता प्राप्त करें",
    "settings.privacy_policy": "गोपनीयता नीति",
    "settings.privacy_policy_subtitle": "हमारी नीतियां पढ़ें",
    "settings.version": "संस्करण 1.0.0",
    "herbs.title": "जड़ी बूटियों को प्रबंधित करें",
    "herbs.add_new": "नई जड़ी बूटी जोड़ें",
    "herbs.add_new_herb": "नई जड़ी बूटी जोड़ें",
    "herbs.add_herb_description": "अपनी प्रयोगशाला की जड़ी बूटी डेटाबेस में एक नई जड़ी बूटी जोड़ें",
    "herbs.category": "श्रेणी",
    "herbs.added_by": "द्वारा जोड़ा गया",
    "herbs.lab_id": "लैब आईडी",
    "herbs.notes": "नोट्स",
    "herbs.no_herbs": "अभी कोई जड़ी बूटी नहीं जोड़ी गई है। शुरू करने के लिए 'नई जड़ी बूटी जोड़ें' पर क्लिक करें।",
    "herbs.herb_name": "जड़ी बूटी का नाम",
    "herbs.herb_name_placeholder": "उदा., तुलसी, अश्वगंधा",
    "herbs.lab_name": "लैब का नाम",
    "herbs.select_category": "एक श्रेणी चुनें",
    "herbs.notes_placeholder": "इस जड़ी बूटी के बारे में वैकल्पिक नोट्स",
    "herbs.save_herb": "जड़ी बूटी बचाएं",
    "common.cancel": "रद्द करें",
    "samples.source_box": "स्रोत बॉक्स",
    "samples.hub_id": "हब आईडी",
    "samples.qr_scan": "स्रोत सत्यापित करने के लिए QR स्कैन करें",
    "samples.auto_creation_info": "नमूने स्वचालित रूप से बनाए जाते हैं जब किसान भंडारण बॉक्स जोड़ते हैं।",
  },
  mr: {
    "login.title": "लॉगिन",
    "login.subtitle": "परत आपले स्वागत आहे, गुणवत्ता विश्लेषक",
    "login.helper_text": "सुरू ठेवण्यासाठी आपला मोबाइल नंबर किंवा ईमेल प्रविष्ट करा",
    "login.mobile": "मोबाइल",
    "login.email": "ईमेल",
    "login.phone": "फोन नंबर",
    "login.email_address": "ईमेल पता",
    "login.send_otp": "OTP पाठवा",
    "login.otp": "OTP प्रविष्ट करा",
    "login.otp_placeholder": "000000",
    "login.verify": "सत्यापित करा",
    "login.resend": "OTP पुन्हा पाठवा",
    "login.resend_in": "{seconds}s मध्ये पुन्हा पाठवा",
    "login.otp_sent": "OTP यशस्वीरित्या पाठवला गेला",
    "login.invalid_otp": "अमान्य OTP. कृपया पुन्हा प्रयास करा.",
    "dashboard.title": "डॅशबोर्ड",
    "dashboard.assigned": "नेमून दिलेले नमुने",
    "dashboard.attention": "लक्ष आवश्यक",
    "dashboard.accuracy": "चाचणी अचूकता",
    "dashboard.activity": "अलीकडील क्रियाकलाप",
    "samples.title": "नमुने",
    "samples.status": "स्थिती",
    "samples.temperature": "तापमान",
    "samples.humidity": "आर्द्रता",
    "samples.test_result": "चाचणी परिणाम",
    "samples.upload_report": "प्रयोगशाळा चाचणी अहवाल अपलोड करा",
    "samples.upload_format": "PDF, JPG, PNG समर्थित",
    "samples.upload_hint": "निवडण्यासाठी क्लिक करा",
    "samples.upload_change": "बदलण्यासाठी क्लिक करा",
    "samples.remarks": "टिप्पणी / निरीक्षण",
    "samples.no_recalls": "कोणत्याही सक्रिय रिकॉल नाहीत",
    "samples.submit": "परिणाम सादर करा",
    "samples.test_result_pass": "पास",
    "samples.test_result_fail": "अयशस्वी",
    "samples.test_result_retest": "पुनः चाचणी आवश्यक",
    "recalls.title": "रिकॉल्स",
    "notifications.title": "सूचना",
    "profile.title": "प्रोफाइल",
    "status.pending": "प्रलंबित",
    "status.in_testing": "चाचणी",
    "status.completed": "पूर्ण",
    "status.rejected": "नाकारले",
    "status.recalled": "मागे घेतले",
    "status.high": "उच्च",
    "status.warning": "इशारा",
    "status.info": "माहिती",
    "nav.dashboard": "होम",
    "nav.samples": "नमुने",
    "nav.herbs": "जड़ी बूटियां",
    "nav.recalls": "रिकॉल्स",
    "nav.profile": "प्रोफाइल",
    "common.batch": "बॅच आयडी",
    "common.logout": "बाहेर पडा",
    "common.close": "बंद करा",
    "common.offline": "तुम्ही ऑफलाइन आहात. जतन केलेला डेटा दाखवत आहे.",
    "profile.mobile_number": "मोबाइल नंबर",
    "profile.area_location": "क्षेत्र / गांव, राज्य",
    "profile.language": "भाषा",
    "profile.not_provided": "प्रदान नहीं किया गया",
    "profile.edit_profile": "प्रोफ़ाइल संपादित करें",
    "profile.settings": "सेटिंग्स",
    "profile.lang_en": "English",
    "profile.lang_hi": "हिंदी",
    "profile.lang_mr": "मराठी",
    "profile.lang_gu": "ગુજરાતી",
    "settings.title": "सेटिंग्स",
    "settings.dark_mode": "डार्क मोड",
    "settings.dark_mode_enabled": "वर्तमान में सक्षम",
    "settings.dark_mode_disabled": "वर्तमान में अक्षम",
    "settings.notifications": "सूचनाएं",
    "settings.notifications_subtitle": "सतर्क सूचनाएं प्राप्त करें",
    "settings.language": "भाषा",
    "settings.help_support": "मदद और समर्थन",
    "settings.help_support_subtitle": "सहायता प्राप्त करें",
    "settings.privacy_policy": "गोपनीयता नीति",
    "settings.privacy_policy_subtitle": "हमारी नीतियां पढ़ें",
    "settings.version": "संस्करण 1.0.0",
    "samples.source_box": "स्रोत बॉक्स",
    "samples.hub_id": "हब आईडी",
    "samples.qr_scan": "स्रोत सत्यापित करने के लिए QR स्कैन करें",
    "samples.auto_creation_info": "नमूने स्वचालित रूप से बनाए जाते हैं जब किसान भंडारण बॉक्स जोड़ते हैं।",
  },
  gu: {
    "login.title": "લૉગિન",
    "login.subtitle": "આપનું આવકાર છે, ગુણવત્તા વિશ્લેષક",
    "login.helper_text": "ચાલુ રાખવા માટે તમારો મોબાઈલ નંબર અથવા ઈમેલ દાખલ કરો",
    "login.mobile": "મોબાઈલ",
    "login.email": "ઈમેલ",
    "login.phone": "ફોન નંબર",
    "login.email_address": "ઈમેલ સરનામું",
    "login.send_otp": "OTP મોકલો",
    "login.otp": "OTP દાખલ કરો",
    "login.otp_placeholder": "000000",
    "login.verify": "સત્યાપિત કરો",
    "login.resend": "OTP ફરીથી મોકલો",
    "login.resend_in": "{seconds}s માં ફરીથી મોકલો",
    "login.otp_sent": "OTP સફળતાપૂર્વક મોકલવામાં આવ્યો",
    "login.invalid_otp": "અમાન્ય OTP. કૃપા કરી ફરીથી પ્રયાસ કરો.",
    "dashboard.title": "ડેશબોર્ડ",
    "dashboard.assigned": "સોંપેલ નમૂનાઓ",
    "dashboard.attention": "ધ્યાન આપો",
    "dashboard.accuracy": "પરીક્ષણ ચોકસાઈ",
    "dashboard.activity": "તાજેતરની પ્રવૃત્તિ",
    "samples.title": "નમૂનાઓ",
    "samples.status": "સ્થિતિ",
    "samples.temperature": "તાપમાન",
    "samples.humidity": "ભેજ",
    "samples.test_result": "પરીક્ષણ પરિણામ",
    "samples.upload_report": "પ્રયોગશાળા પરીક્ષણ અહેવાલ અપલોડ કરો",
    "samples.upload_format": "PDF, JPG, PNG સમર્થિત",
    "samples.upload_hint": "પસંદ કરવા માટે ક્લિક કરો",
    "samples.upload_change": "બદલવા માટે ક્લિક કરો",
    "samples.remarks": "મંતવ્યો / નિરીક્ષણો",
    "samples.no_recalls": "કોઈ સક્રિય રિકોલ્સ નથી",
    "samples.submit": "પરિણામ સબમિટ કરો",
    "samples.test_result_pass": "પાસ",
    "samples.test_result_fail": "નિષ્ફળ",
    "samples.test_result_retest": "પુનઃ પરીક્ષણ જરૂરી",
    "recalls.title": "રિકોલ્સ",
    "notifications.title": "સૂચનાઓ",
    "profile.title": "પ્રોફાઇલ",
    "status.pending": "બાકી",
    "status.in_testing": "પરીક્ષણ",
    "status.completed": "પૂર્ણ",
    "status.rejected": "નકારી કાઢ્યું",
    "status.recalled": "પરત મંગાવી",
    "status.high": "ઉચ્ચ",
    "status.warning": "ચેતવણી",
    "status.info": "માહિતી",
    "nav.dashboard": "હોમ",
    "nav.samples": "નમૂનાઓ",
    "nav.recalls": "રિકોલ્સ",
    "nav.profile": "પ્રોફાઇલ",
    "common.batch": "બેચ આઈડી",
    "common.logout": "લોગ આઉટ",
    "common.close": "બંધ કરો",
    "common.offline": "તમે ઑફલાઇન છો. સાચવેલ ડેટા બતાવી રહ્યું છે.",
    "profile.mobile_number": "મોબાઇલ નંબર",
    "profile.area_location": "વિસ્તાર / ગામ, રાજ્ય",
    "profile.language": "ભાષા",
    "profile.not_provided": "આપવામાં આવ્યું નથી",
    "profile.edit_profile": "પ્રોફાઇલ સંપાદિત કરો",
    "profile.settings": "સેટિંગ્સ",
    "profile.lang_en": "English",
    "profile.lang_hi": "हिंदी",
    "profile.lang_mr": "मराठी",
    "profile.lang_gu": "ગુજરાતી",
    "settings.title": "સેટિંગ્સ",
    "settings.dark_mode": "ડાર્ક મોડ",
    "settings.dark_mode_enabled": "હાલમાં સક્ષમ",
    "settings.dark_mode_disabled": "હાલમાં અક્ષમ",
    "settings.notifications": "સૂચનાઓ",
    "settings.notifications_subtitle": "સતર્ક સૂચનાઓ પ્રાપ્ત કરો",
    "settings.language": "ભાષા",
    "settings.help_support": "મદદ અને સમર્થન",
    "settings.help_support_subtitle": "સહાય મેળવો",
    "settings.privacy_policy": "ગોપનીયતા નીતિ",
    "settings.privacy_policy_subtitle": "અમારી નીતિઓ વાંચો",
    "settings.version": "સંસ્કરણ 1.0.0",
    "samples.source_box": "સ્રોત બોક્સ",
    "samples.hub_id": "હબ આઈડી",
    "samples.qr_scan": "સ્રોત ચકાસવા માટે QR સ્કેન કરો",
    "samples.auto_creation_info": "જ્યારે ખેડૂતો સંગ્રહ બોક્સ ઉમેરે છે ત્યારે નમૂનાઓ આપોઆપ બનાવવામાં આવે છે.",
  },
};

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [language, setLanguageState] = useState<Language>("en");

  useEffect(() => {
    const saved = localStorage.getItem("herbtrace-lang") as Language;
    if (saved && ["en", "hi", "mr", "gu"].includes(saved)) {
      setLanguageState(saved);
    }
  }, []);

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
    localStorage.setItem("herbtrace-lang", lang);
  };

  const t = (key: string, params?: Record<string, string | number>) => {
    let text = translations[language][key] || key;
    if (params) {
      Object.entries(params).forEach(([k, v]) => {
        text = text.replace(`{${k}}`, String(v));
      });
    }
    return text;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useLanguage() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error("useLanguage must be used within a LanguageProvider");
  }
  return context;
}
